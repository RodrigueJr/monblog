<!DOCTYPE html>
<html>
  <head>
    <title>L&#39;encodage de caract√®re</title>
    <meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta http-equiv="X-UA-Compatible" content="ie=edge" />


<link rel="stylesheet" href="/assets/css/bootstrap.min.css"/>
<link rel="stylesheet" href="/assets/css/layouts/main.css"/>
<link rel="stylesheet" href="/assets/css/style.css"/>
<link rel="stylesheet" href="/assets/css/navigators/navbar.css"/>


<link href="https://fonts.googleapis.com/css2?family=Muli:wght@300;400;500;600" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" />


<link rel="icon" type="image/png" href="/assets/images/favicon.png" />


<link rel="stylesheet" href="/assets/css/style.css"/>

    
<meta name="description" content="L&#39;encodage de caract√®re" />
<link
  rel="stylesheet"
  href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/atom-one-dark.min.css"
/>
<link rel="stylesheet" href="/assets/css/layouts/single.css"/>
<link rel="stylesheet" href="/assets/css/navigators/sidebar.css">


    
    
      
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-171649523-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

    
  </head>

  <body data-spy="scroll" data-target="#TableOfContents" data-offset="80">
    <div class="container-fluid bg-dimmed wrapper">
      
      
    




<nav class="navbar navbar-expand-xl top-navbar final-navbar shadow">
  <div class="container">
      <button class="navbar-toggler navbar-light" id="sidebar-toggler" type="button" onclick="toggleSidebar()">
      <span class="navbar-toggler-icon"></span>
    </button>
    <a class="navbar-brand" href="/">
      <img src="/assets/images/main-logo.png">Red</a>
    <button class="navbar-toggler navbar-light" id="toc-toggler" type="button" onclick="toggleTOC()">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse lang-selector" id="top-nav-items">
      <ul class="navbar-nav ml-auto">
      
      </ul>
    </div>
  </div>
  
  <img src="/assets/images/main-logo.png" class="d-none" id="main-logo">
  <img src="/assets/images/inverted-logo.png" class="d-none" id="inverted-logo">
</nav>



      
      
  <section class="sidebar-section" id="sidebar-section">
    <div class="sidebar-holder">
      <div class="sidebar" id="sidebar">
        <input type="text" value="" placeholder="Search" data-search="" id="search-box" />
        <div class="sidebar-tree">
          <ul class="tree" id="tree">
            <li id="list-heading"><a href="https://rodrigue.netlify.appposts" data-filter="all">Posts</a></li>
            <div class="subtree">
                

            </div>
          </ul>
        </div>
      </div>
    </div>
  </section>


      
      
<section class="content-section" id="content-section">
  <div class="content">
    <div class="container p-0 read-area">
      
      <div class="hero-area col-sm-12" id="hero-area" style='background-image: url(https://rodrigue.netlify.app/assets/images/default-hero.jpg);'>
      </div>

      
      <div class="page-content">
        <div class="author-profile ml-auto align-self-lg-center">
          <img class="rounded-circle" src='/images/avatar_test%20%282%29.jpeg'/>
          <h5 class="author-name"></h5>
          <p>October 25, 2020</p>
        </div>

        <div class="title">
          <h1>L&#39;encodage de caract√®re</h1>
        </div>

        <div class="post-content" id="post-content">
          


<div id="lencodage-de-caract√®re-cest-quoi" class="section level1">
<h1>L‚Äôencodage de caract√®re c‚Äôest quoi ?</h1>
<p>Un ordinateur ne peut stocker que des nombres, ou plus pr√©cis√©ment des 0 et des 1 (des ¬´ bits ¬ª) qu‚Äôon regroupe pour former des nombres en binaire.</p>
<p>Comment fait-on alors pour √©crire du texte ? La r√©ponse est toute b√™te : on associe √† chaque caract√®re (une lettre, un signe de ponctuation, une espace‚Ä¶) un nombre. Un texte est alors une suite de ces nombres, on parle de cha√Æne de caract√®res.</p>
<p>L‚Äô<a href="https://fr.wikipedia.org/wiki/Codage_des_caract%C3%A8res">encodage</a> est une table de correspondance entre un ordinateur et le langage humain (fran√ßais, anglais, chinois‚Ä¶).</p>
<blockquote>
<p>Si vous voulez aller plus loin sur l‚Äôencodage et son histoire, nous vous recommandons ce tutoriel : <a href="http://sdz.tdct.org/sdz/comprendre-les-encodages.html">Comprendre les encodages</a>.</p>
</blockquote>
</div>
<div id="utf-8-lencodage-r√©f√©rence" class="section level1">
<h1>UTF-8: l‚Äôencodage r√©f√©rence</h1>
<p>Au fil des ann√©es plusieurs encodages ont √©t√© cr√©√©s. Un a finalement r√©ussi √† regrouper presque tous les langages. Il s‚Äôagit de L‚Äô<a href="https://fr.wikipedia.org/wiki/Unicode">Unicode</a>. Il y a plusieurs impl√©mentations concr√®tes d‚ÄôUnicode. Le plus c√©l√®bre est ‚ÄúUTF-8‚Äù. L‚Äô<a href="https://fr.wikipedia.org/wiki/UTF-8">UTF-8</a> est le seul encodage vers lequel, aujourd‚Äôhui, on puisse convertir vers et depuis (pratiquement) toutes les langues au monde.</p>
<p>Suivant le syst√®me d‚Äôexploitation que vous utilisez, l‚Äôencodage par d√©faut n‚Äôest pas le m√™me.</p>
<p>Par exemple, les syst√®mes d‚Äôexploitation <strong>Linux</strong> utilisent en g√©n√©ral par d√©faut l‚Äôencodage <strong>UTF-8</strong>. Par contre sous Windows l‚Äôencodage par d√©faut est g√©n√©ralement <strong>Windows 1252</strong>.</p>
</div>
<div id="lencodage-sur-linux" class="section level1">
<h1>L‚Äôencodage sur Linux</h1>
<p>Si vous travailler avec des VM notamment via des plateformes clous (CGP, AWS, AZURE‚Ä¶), il y a de fortes chances que vous travaillez sous Linux. Par cons√©quent l‚Äôencodage par d√©faut est <strong>UTF-8</strong>. Ceci implique que lors de l‚Äôimportation ou de l‚Äôexportation des donn√©es, les caract√®res seront encod√©s par d√©faut en UTF-8.</p>
</div>
<div id="illustration-des-probl√®mes-li√©s-√†-lencodage-sur-les-donn√©es" class="section level1">
<h1>Illustration des probl√®mes li√©s √† l‚Äôencodage sur les donn√©es</h1>
<div id="exemple-1-vm-linux-vers-excel-bureau" class="section level2">
<h2>Exemple 1 : VM Linux vers Excel Bureau</h2>
<p>Construisons une table depuis notre environnement Linux avec des caract√®res sp√©ciaux:</p>
<pre class="r"><code>df &lt;- tibble::tibble(nom = c(&quot;√âric&quot;, &quot;Nathan√´l&quot;), entreprise = c(&quot;R√©seau de Transport d&#39;√©lectricit√©&quot;, &quot;R√©seau de Transport d&#39;√©lectricit√©&quot;))
df</code></pre>
<pre><code>## # A tibble: 2 x 2
##   nom      entreprise                       
##   &lt;chr&gt;    &lt;chr&gt;                            
## 1 √âric     R√©seau de Transport d&#39;√©lectricit√©
## 2 Nathan√´l R√©seau de Transport d&#39;√©lectricit√©</code></pre>
<p>Sauvegardons notre table dans un csv.</p>
<pre class="r"><code>readr::write_csv2(df, &quot;df.csv&quot;)</code></pre>
<p>Exportons ensuite le fichier vers notre poste windows (Onglet <strong>Files</strong> puis <strong>More &gt; Export</strong>) et ouvrons le dans excel en double-cliquant sur le fichier.</p>
<p>Normalement la table ressemble √† ca:</p>
<p><img src="/images/post-rmarkdown/encodage_linux_windows.png" /></p>
<p>Les caract√®res sp√©ciaux ont √©t√© transform√©s en des caract√®res ‚Äúbizarres‚Äù.</p>
</div>
<div id="exemple-2-excel-bureau-vers-linux" class="section level2">
<h2>Exemple 2: Excel Bureau vers Linux</h2>
<p>Cr√©ons un fichier csv depuis excel sur notre poste bureautique avec des caract√®res sp√©ciaux.
<img src="/images/post-rmarkdown/encodage_windows_linux.png" /></p>
<p>On le t√©l√©charge sur Rstudio dans Linux (bouton <strong>Upload</strong> dans l‚Äôonglet <strong>Files</strong>) et on l‚Äôimporte en m√©moire</p>
<pre class="r"><code>df2 &lt;- readr::read_csv2(&quot;/data_post/example_encoding.csv&quot;)

df2</code></pre>
<p>A l‚Äôaffichage, les caract√®res sp√©ciaux ont √©t√© transform√©s en des caract√®res ‚Äúbizarres‚Äù.</p>
<p>Voici illustr√© en deux exemples, les probl√®mes d‚Äôencodage que vous pourriez avoir.
Ce qui s‚Äôest pass√©, c‚Äôest que comme Linux et windows n‚Äôutilise pas le m√™me encodage par d√©faut, certains caract√®res ont √©t√© mal retranscrits.</p>
</div>
</div>
<div id="bien-g√©rer-lencodage" class="section level1">
<h1>Bien g√©rer l‚Äôencodage</h1>
<div id="a-la-lecture-des-donn√©es" class="section level2">
<h2>A la lecture des donn√©es</h2>
<p>La solution pour bien lire les donn√©es (que ce soit dans Linux ou Windows) est de sp√©cifier l‚Äôencodage qui a servi pour enregistrer les donn√©es.</p>
<div id="dans-excel" class="section level3">
<h3>Dans Excel</h3>
<p>Dans la premi√®re illustration, il faut ouvrir le fichier csv dans excel en sp√©cifiant UTF-8 comme encodage.</p>
<p>Pour cela, il faut ouvrir une page excel vierge puis aller dans <strong>DONN√âES &gt; Fichier texte</strong>.
S√©lectionnez votre fichier. Dans l‚Äôassistant d‚Äôimportation de texte √† l‚Äô√©tape 1 vous avez <strong>Origine du fichier</strong>. S√©lectionnez
<strong>65001 : Unicode (UTF-8)</strong> puis suivez le reste des √©tapes jusqu‚Äô√† la fin.</p>
<p>Apr√®s importation, les caract√®res sp√©ciaux devraient s‚Äôafficher normalement.</p>
</div>
<div id="dans-linux" class="section level3">
<h3>Dans Linux</h3>
<p>Dans la deuxi√®me illustration, il faut lire le fichier csv dans Linux en sp√©cifiant <strong>WINDOWS-1252</strong> comme encodage.</p>
<pre class="r"><code>df2 &lt;- readr::read_csv2(&quot;/data_post/example_encoding.csv&quot;, locale = readr::locale(encoding = &quot;WINDOWS-1252&quot;))

df2</code></pre>
<blockquote>
<p>Presque toutes les fonctions de lecture de fichier dans R ont une option qui permet de sp√©cifier l‚Äôencodage (<code>fileEncoding</code> pour <code>read.\*</code>, <code>encoding</code> pour <code>fread</code>, <code>local</code> pour <code>read_*</code> ‚Ä¶)</p>
</blockquote>
<p>Vous pouvez aussi modifier l‚Äôencodage des caract√®res apr√®s lecture avec <code>parse_character</code>.</p>
<pre class="r"><code>df2 &lt;- readr::read_csv2(&quot;/data_post/example_encoding.csv&quot;)

df2

# On change l&#39;encodage de tous les types caract√®res
df2 &lt;- dplyr::mutate_all(df2, function(x){readr::parse_character(x, locale = readr::locale(encoding = &quot;WINDOWS-1252&quot;))})
df2</code></pre>
</div>
</div>
<div id="a-l√©criture-des-donn√©es" class="section level2">
<h2>A l‚Äô√©criture des donn√©es</h2>
<p>A l‚Äô√©criture des donn√©es vous avez deux choix possibles :</p>
<ul>
<li>Sp√©cifier l‚Äôencodage lors de l‚Äô√©criture</li>
</ul>
<p>Pour faire cela nous allons utiliser les fonctions de base dans R <code>file</code> et <code>write.csv2</code></p>
<pre class="r"><code>con&lt;-file(&#39;df.csv&#39;,encoding=&quot;WINDOWS-1252&quot;)
write.csv2(df,file=con)</code></pre>
<blockquote>
<p>NOTE: Il n‚Äôa pas √©t√© pr√©vu la sp√©cification de l‚Äôencodage avec la fonction <code>write_csv2</code> de <code>readr</code> ni <code>fwrite</code> pour <code>data.table</code>. Ils √©crivent toujours en UTF-8. La requ√™te pr√©c√©dente ne changera donc pas l‚Äôencodage si vous utilisez <code>write_csv2</code> (<code>fwrite</code> ne prend pas de param√®tre de type <code>connection</code>).</p>
</blockquote>
<ul>
<li>Rajouter un Indicateur d‚Äôordre des octets (Byte Order Mark)</li>
</ul>
<p>En Unicode, <a href="https://fr.wikipedia.org/wiki/Indicateur_d%27ordre_des_octets">l‚Äôindicateur d‚Äôordre des octets</a> ou BOM (pour l‚Äôanglais byte order mark) est une donn√©e qui indique l‚Äôutilisation d‚Äôun encodage Unicode ainsi que l‚Äôordre des octets, g√©n√©ralement situ√© au d√©but de certains fichiers texte.</p>
<p>Pour dire simple le BOM sp√©cifie lors de l‚Äô√©criture que le fichier est encod√© en Unicode (UTF-8 dans notre cas).</p>
<p>Pour faire cela, on utilise la fonction <code>write_excel_csv2</code> de <code>readr</code></p>
<pre class="r"><code>readr::write_excel_csv2(df, &quot;df-UTF8-BOM.csv&quot;)</code></pre>
<p>A l‚Äôouverture dans tout autre environnement (Excel bureau dans notre cas), L‚Äôencodage UTF-8 sera automatiquement utilis√©.</p>
</div>
</div>
<div id="et-mes-scripts-dans-tout-√ßa" class="section level1">
<h1>Et mes scripts dans tout √ßa ü§î?</h1>
<p>Si vous r√©digez/r√©cup√©rez des scripts r√©dig√©s dans deux environnements diff√©rents (Rstudio en local sur votre poste Windows et Linux) vous aurez surement des soucis avec les caract√®res sp√©ciaux lors du passage d‚Äôun environnement √† l‚Äôautre.</p>
<p>Pour √©viter ces d√©sagr√©ments dans vos scripts, nous vous conseillons fortement de mettre l‚Äôencodage UTF-8 par d√©faut sur votre Rstudio Linux et windows.</p>
<p>Pour le faire, allez dans <strong>Tools &gt; Global Option &gt; Code &gt; Saving &gt; Default text encoding</strong> et mettez UTF-8.</p>
<p>Si vous disposez d‚Äôun script d√©j√† √©crit dans un autre encodage, vous pouvez le r√©ouvrir en sp√©cifiant le bon encodage. Ouvrez le fichier puis allez dans <strong>File &gt; Reopen with encoding</strong>.</p>
<p>Vous pouvez ensuite faire <strong>File &gt; Save with encoding</strong> pour l‚Äôenregistrer en UTF-8.</p>
</div>
<div id="nos-conseils" class="section level1">
<h1>Nos conseils üôÇ</h1>
<blockquote>
<p>UTF-8, j‚Äôutiliserai‚Ä¶</p>
</blockquote>
<ul>
<li>R√©glez votre R local en UTF8</li>
<li>R√©glez l‚Äôencodage √† la lecture de vos fichiers</li>
<li>Convertissez vos scripts en UTF-8 s‚Äôils ne le sont pas</li>
<li>Si vous rencontrez des probl√®mes de caract√®res bizarres, c‚Äôest surement li√© √† un mauvais encodage utilis√© √† la lecture.</li>
<li>Dans R il y a des fonctions qui peuvent aider √† identifier l‚Äôencodage si vous avez des doutes (<code>readr::guess_encoding</code> par exemple)</li>
</ul>
</div>
<div id="quelques-articles-sur-lencodage-dans-r" class="section level1">
<h1>Quelques articles sur l‚Äôencodage dans R</h1>
<ul>
<li><a href="https://freakonometrics.hypotheses.org/52168">Unicode, UTF-8‚Ä¶ la base de l‚Äôencodage</a></li>
<li><a href="https://support.rstudio.com/hc/en-us/articles/200532197-Character-Encoding">Script Encoding</a></li>
<li><a href="https://kevinushey.github.io/blog/2018/02/21/string-encoding-and-r/">Write UTF-8 encoded content to a file</a></li>
<li><a href="https://readr.tidyverse.org/articles/locales.html#character">Character with <code>readr</code></a></li>
<li><a href="https://appsilon.com/writing-excel-formatted-csv-using-readrwrite_excel_csv2/">Writing excel formatted csv using <code>readr::write_excel_csv2</code></a></li>
<li><a href="https://irene.rbind.io/post/encoding-in-r/">Encoding in R</a></li>
</ul>
</div>

        </div>

        
        
          <div class="btn-improve-page">
              <a href="https://github.com/RodrigueJr/monblog/edit/master/content/posts%5cR%5c2020-10-25-encodage.html">
                <i class="fas fa-code-branch"></i>
                Improve This Page
              </a>
          </div>
        

        
      <hr />
        <div class="row next-prev-navigator">


  

  

  

  
    
    
      
        
        
        <div class="col-md-12 next-article">
          <a href="/posts/r/ti/" class="btn btn-outline-info">
            <span>Next <i class="fas fa-chevron-circle-right"></i></span>
            <br />
            <span>Introdution au Tidyverse</span>
          </a>
        </div>
      
    
  

</div>

      <hr />
      
      
          <div id="disqus_thread"></div>
<script type="text/javascript">
  (function () {
    
    
    if (window.location.hostname == "localhost") return;

    var dsq = document.createElement("script");
    dsq.type = "text/javascript";
    dsq.async = true;
    var disqus_shortname = "true";
    dsq.src = "//" + disqus_shortname + ".disqus.com/embed.js";
    (
      document.getElementsByTagName("head")[0] ||
      document.getElementsByTagName("body")[0]
    ).appendChild(dsq);
  })();
</script>
<noscript
  >Please enable JavaScript to view the
  <a href="https://disqus.com/?ref_noscript"
    >comments powered by Disqus.</a
  ></noscript
>
<a href="https://disqus.com/" class="dsq-brlink"
  >comments powered by <span class="logo-disqus">Disqus</span></a
>

      
      </div>
    </div>
  </div>
  
</section>


      
      
  <section class="toc-section" id="toc-section">
    
  </section>

    </div>

    

  




  




  
  
    
  


<footer class="container-fluid text-center align-content-center footer pb-2">
  <div class="container pt-5">
    <div class="row text-left">
      <div class="col-md-4 col-sm-12">
        <h5>Naviguation</h5>
        
        <ul>
            
              
              
                
              
              <li class="nav-item">
                <a class="smooth-scroll" href="#about">A Propos</a>
              </li>
            
            
            
              
              
                
              
              <li class="nav-item">
                <a class="smooth-scroll" href="#experiences">Experiences</a>
              </li>
            
            
            
              
              
                
              
              <li class="nav-item">
                <a class="smooth-scroll" href="#Recent%20Posts">Posts Recent</a>
              </li>
            
            
        </ul>
        

      </div>
      
      <div class="col-md-4 col-sm-12">
        <h5>Contactez moi :</h5>
        <ul>
          
          <li><span>Email: </span> <span>rodrigue.edorh@yahoo.fr</span></li>
          
        </ul>
      </div>
      
      
    </div>
  </div>
  <hr />
  <div class="container">
    <div class="row text-left">
      <div class="col-md-4">
        <a id="theme" href="https://github.com/hossainemruz/toha" target="#">
          <img src="/assets/images/inverted-logo.png">
          Toha
        </a>
      </div>
      <div class="col-md-4 text-center">¬© 2020 Droits d&#39;auteur.</div>
      <div class="col-md-4 text-right">
        <a id="hugo" href="https://gohugo.io/">Aliment√© par
        <img
          src="/assets/images/hugo-logo-wide.svg"
          alt="Hugo Logo"
          height="18"
        />
        </a>
      </div>
    </div>
  </div>
</footer>

    <script src="/assets/js/jquery-3.4.1.min.js"></script>
<script src="/assets/js/popper.min.js"></script>
<script src="/assets/js/bootstrap.min.js"></script>

<script src="/assets/js/navbar.js"></script>
<script src="/assets/js/main.js"></script>


    
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js"></script>
<script src="/assets/js/single.js"></script>
<script>
  hljs.initHighlightingOnLoad();
</script>


  </body>
</html>
