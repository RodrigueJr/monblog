---
title: "DÃ©buter dans Rstudio"
author: Rodrigue EDORH
date: 2020-10-25
hero: /images/post-rmarkdown/hex-tidyverse.png
slug: tidyverse
categories: ["R"]
tags: ["R Markdown"]
menu:
  sidebar:
    name: Tidyverse
    identifier: r-tidy
    parent: r
    weight: 100
---



<div id="rstudio-lide-dÃ©diÃ©-Ã -r" class="section level1">
<h1>Rstudio: lâ€™IDE dÃ©diÃ© Ã  R</h1>
<p>Rstudio est un environnement de dÃ©veloppement (IDE) dÃ©diÃ© pour le langage <a href="https://www.r-project.org/about.html">R</a>. Il se base sur le logiciel libre <a href="https://www.r-project.org/">GNU R</a>.</p>
<p>Son interface comporte 3 cadrans et se prÃ©sente comme suit :</p>
<p><img src="www/image/interfaceRstudio1.png" /></p>
<p><br></p>
<ol style="list-style-type: decimal">
<li><p>Le Cadran 1 : est constituÃ© dâ€™une <strong>Console</strong> et dâ€™un <strong>Terminal</strong>.</p>
<ul>
<li><strong>Console</strong> : dans la console vous pourrez Ã©crire toutes vos commandes (mais on verra plus tard quâ€™il est mieux dâ€™Ã©crire ses commandes dans un script avant de les compiler dans la console).</li>
<li><strong>Terminal</strong> : il donne accÃ¨s Ã  une interface systÃ¨me (shell) (pratique pour saisir des lignes de commandes notamment pour faire du Git ou compiler un script externe comme du Python). On peut crÃ©er plusieurs terminaux. (<a href="https://support.rstudio.com/hc/en-us/articles/115010737148-Using-the-RStudio-Terminal">rÃ©fÃ©rence</a>)</li>
</ul></li>
<li><p>Le Cadran 2 : contient les onglets <strong>Environnement</strong>, <strong>History</strong> et <strong>Connections</strong>.</p>
<ul>
<li><strong>Environnement</strong> : il vous affiche tous les objets (table de donnÃ©es, vecteurs, listeâ€¦) que vous aurez crÃ©Ã©s/importÃ©s dans Rstudio (et qui sont stockÃ©s dans la mÃ©moire de votre environnement).</li>
<li><strong>History</strong> : il vous affiche tout lâ€™historique de votre travail, câ€™est Ã  dire tous les codes R compilÃ©s dans la console au cadran 1</li>
<li><strong>Connections</strong> : cet onglet est une assistance pour se connecter Ã  des tables distantes (plus de dÃ©tails dans <a href="ConnectionDatalake.html">AccÃ¨s au DataLake</a>)</li>
</ul></li>
<li><p>Le Cadran 3 : il contient cinq onglets :</p>
<ul>
<li><strong>Files</strong>: il permet de visualiser votre dossier physique de travail. Par dÃ©faut il sera dans votre <em>â€œHomeâ€</em>. Depuis cet onglet, vous aller pouvoir crÃ©er un nouveau dossier, tÃ©lÃ©charger des fichiers depuis votre ordinateur, supprimer/renommer/dÃ©placer/copier des fichiers.</li>
<li><strong>Plots</strong>: il affichera toutes vos sorties graphiques (histogramme, pie chart, box plot â€¦).</li>
<li><strong>Packages</strong>: il vous affiche lâ€™ensemble des librairies disponibles dans votre environnement. Vous avez la libertÃ© de tÃ©lÃ©charger dâ€™autres librairies avec le bouton <strong>Install</strong>.</li>
<li><strong>Help</strong>: il vous affichera toute la documentation dÃ©diÃ© Rstudio</li>
<li><strong>viewer</strong> : Câ€™est une interface interne qui permet de visualiser vos applications Shiny.</li>
</ul></li>
</ol>
<p>Ce petit aide-mÃ©moire pourra vous Ãªtre utile :</p>
<p><a href="https://www.rstudio.com/wp-content/uploads/2016/02/IDE-french.pdf" id="id" class="class" width="100%" height="500"><img src="www/image/rstudioIDE.PNG" title="cliquez pour suivre le lien" /></a></p>
</div>
<div id="comment-fonctionne-r" class="section level1">
<h1>Comment fonctionne R</h1>
<p>R est langage informatique dÃ©diÃ© aux statistiques et Ã  la science des donnÃ©es. Câ€™est un langage interprÃ©tÃ©, câ€™est Ã  dire que les commandes saisies au clavier sont directement exÃ©cutÃ©es sans quâ€™il y ait besoin de construire un programme complet (contrairement aux langages compilÃ©s comme C ou c++). On peut donc vÃ©rifier pas Ã  pas ces lignes de commandes.</p>
<p>R fonctionne avec des objets qui peuvent Ãªtre des variables, des listes, des data.frames, des tibblesâ€¦</p>
<p>##CommenÃ§ons par â€œcoderâ€</p>
<blockquote>
<h6 id="note-dans-global-optionappearance-vous-pouvez-aussi-changer-lapparence-de-votre-environnement-rstudio-par-exemple-en-fond-noir-moins-consommatrice-dÃ©nergie-et-qui-en-passant-fatigue-moins-les-yeux"><em>Note</em> : Dans <strong>Global Option&gt;Appearance</strong>, vous pouvez aussi changer lâ€™apparence de votre environnement Rstudio (par exemple en fond noir moins consommatrice dâ€™Ã©nergie et qui en passant fatigue moins les yeux ğŸ˜‰</h6>
</blockquote>
<p>Si vous cliquez dans le cadran 1 vous verrez le curseur clignotÃ© juste aprÃ¨s le symbole <code>&gt;</code>. Câ€™est lÃ  que sera Ã©crit votre code.</p>
<p>CommenÃ§ons par un calcul tout simple dâ€™addition :</p>
<pre class="r"><code>1+1</code></pre>
<pre><code>## [1] 2</code></pre>
<p>Le rÃ©sultat est directement affichÃ© dans la console.</p>
<div id="crÃ©ation-dobjet" class="section level3">
<h3>CrÃ©ation dâ€™objet</h3>
<ul>
<li>CrÃ©er et afficher une variable</li>
</ul>
<p>La crÃ©ation dâ€™objet dans R est assez simple. Si on veut crÃ©er une variable numÃ©rique <strong>a</strong> qui vaut <strong>5</strong>, il suffit de faire ceci <code>a&lt;-5</code>. Lâ€™opÃ©rateur <code>&lt;-</code> permet dâ€™affecter une valeur Ã  une variable. Pour afficher le contenue de <code>a</code> il suffit de saisir <code>a</code> dans la console puis de valider.</p>
<pre class="r"><code>a&lt;-5
a</code></pre>
<pre><code>## [1] 5</code></pre>
<p>Pour crÃ©er une variable qui contient du texte, la syntaxe est la mÃªme avec une petite nuance; on Ã©crit le texte dans des guillemets.</p>
<pre class="r"><code>toto&lt;-&quot;Je suis GÃ©nial&quot;
toto</code></pre>
<pre><code>## [1] &quot;Je suis GÃ©nial&quot;</code></pre>
<ul>
<li>CrÃ©er un vecteur</li>
</ul>
<p>Pour crÃ©er un vecteur (suite de valeur), on sâ€™aide de la fonction <code>c()</code> qui permet de combiner des arguments.
La syntaxe est la suivante pour crÃ©er un vecteur <code>a</code> comprenant les valeurs 1,2,3,4,5:</p>
<pre class="r"><code>a&lt;-c(1,2,3,4,5)
a</code></pre>
<pre><code>## [1] 1 2 3 4 5</code></pre>
</div>
<div id="mon-premier-script" class="section level2">
<h2>Mon premier script</h2>
<p>Comme on lâ€™a vue prÃ©cÃ©demment, on Ã©crit et exÃ©cute un code dans la console. Cependant travailler de cette maniÃ¨re ne permet pas de stocker son historique surtout si on doit rÃ©diger une suite de code.</p>
<p>Pour pouvoir garder tout son historique, on va plutÃ´t travailler dans des fichiers Scripts.</p>
<p>Le raccourci pour crÃ©er un nouveau script est <strong>Ctrl + Shift + N</strong>. Un nouveau cadran apparait en haut Ã  gauche de votre environnement</p>
<p><img src="www/image/newScript.PNG" /></p>
<p><br></p>
<p>Vous pouvez dans ce script Ã©crire tous vos codes, lâ€™enregistrer. Lâ€™intÃ©rÃªt dâ€™un script est aussi sa portabilitÃ©. Voyez un script R comme un bloc-notes dans lequel on Ã©crit des codes comprÃ©hensibles par R.</p>
<p>On ne sâ€™Ã©tend pas trop sur comment programmer dans R mais pour une prise en main rapide nous vous conseillons ces tutoriels sur:</p>
<ul>
<li><a href="https://cran.r-project.org/doc/contrib/Paradis-rdebuts_fr.pdf">Cran doc 1</a> ou <a href="https://cran.r-project.org/doc/contrib/Goulet_introduction_programmation_R.pdf">Cran doc2</a></li>
<li><a href="https://openclassrooms.com/courses/effectuez-vos-etudes-statistiques-avec-r/premiers-pas-avec-r">Openclassrooms</a>.</li>
<li><a href="https://www.datacamp.com">datacamp</a> (Il faut par contre crÃ©er un compte pour avoir accÃ¨s). Vous disposez aussi dâ€™une application smartphone <strong><em>DataCamp - Learn R &amp; Python</em></strong> assez â€œ<em>User Friendly</em>â€ qui vous permet de comprendre et dâ€™acquÃ©rir rapidement les bases de la programmation.</li>
</ul>
</div>
</div>
<div id="les-packages-r" class="section level1">
<h1>Les Packages R</h1>
<div id="le-concept-de-packages-librairie" class="section level2">
<h2>Le concept de <strong>packages</strong> (librairie)</h2>
<p>R fait appel Ã  des <strong>librairies</strong>. Ces librairies contiennent des fonctions, mÃ©thodes, donnÃ©es â€¦ qui permettent de travailler facilement.</p>
<p>Il existe un rÃ©pertoire officiel qui liste toutes les librairies disponibles. Il sâ€™agit du <strong>Comprehensive R Archive Network (CRAN)</strong>.</p>
<p>Deux maniÃ¨res pour installer une librairie :</p>
<ul>
<li><p>Utiliser lâ€™assistant : Dans le cadran 3 (en bas Ã  droite) cliquer sur <strong>Packages</strong> puis sur <strong>Install</strong>. Dans la barre de dialogue qui sâ€™affiche, saisissez votre librairie puis <strong>Install</strong>.</p></li>
<li><p>Saisir en ligne de commande: la fonction <code>install.packages()</code> permet dâ€™installer une librairie. Ex : <code>install.packages(readr)</code></p></li>
</ul>
</div>
</div>
<div id="organiser-son-espace-de-travail" class="section level1">
<h1>Organiser son espace de travail</h1>
<p>Pour travailler de maniÃ¨re efficace, travaillez sous forme de projet ce qui vous permettra dâ€™Ãªtre plus organisÃ©.</p>
<div id="travailler-sous-forme-de-projet" class="section level2">
<h2>Travailler sous forme de <strong>projet</strong></h2>
<p>Les projets RStudio simplifient la division de votre travail en plusieurs contextes, chacun avec son propre rÃ©pertoire de travail, espace de travail, historique et documents sources.
Travailler sous forme de projet, câ€™est se simplifier la vie. Vous pouvez switcher dâ€™un projet Ã  lâ€™autre sans aucun souci. En plus vous pouvez ouvrir plusieurs projets Ã  la fois sous forme de session (on reviendra sur le concept des sessions plus tard).</p>
<p>Pour crÃ©er un projet voici les Ã©tapes:</p>
<ul>
<li>Aller dans <strong>Files&gt;New Project</strong></li>
</ul>
<p><img src="www/image/createProject1.png" /></p>
<p><br></p>
<ul>
<li>Choisissez <strong>New Directory</strong> puis <strong>New Project</strong></li>
</ul>
<p><img src="www/image/newProjet.PNG" /></p>
<p><br></p>
<ul>
<li>Saisir le nom de votre Projet puis cliquez sur <strong>Create Project</strong></li>
</ul>
<p><img src="www/image/newProjet1.PNG" /></p>
<p><br>
Vous venez ainsi de crÃ©er votre nouveau projet. Un dossier <strong>Mon_Premier_Projet</strong> a Ã©tÃ© crÃ©Ã© dans votre <em>Home</em> et contiendra tous vos scripts.</p>
<p><img src="www/image/firstProjec1t.png" /></p>
<p><br></p>
<p>Un fichier dâ€™extension <strong>Rproj</strong> est Ã©galement crÃ©Ã© <img src="www/image/firstProject2.png" /></p>
<div id="fonctionnement-par-dÃ©faut-des-projets" class="section level3">
<h3>Fonctionnement par dÃ©faut des projets</h3>
<p>Lorsque lâ€™on ouvre un projet, RStudio effectue diffÃ©rentes actions :</p>
<ul>
<li>le nom du projet est affichÃ© en haut Ã  droite Ã  cÃ´tÃ© de lâ€™icÃ´ne projets ;</li>
<li>une nouvelle session R est exÃ©cutÃ©e (ainsi sâ€™il on passe dâ€™un projet Ã  un autre, les objets du projet quâ€™on vient de fermer ne sont plus en mÃ©moire) ;</li>
<li>le rÃ©pertoire de travail de R est dÃ©fini comme Ã©tant le rÃ©pertoire du projet (dâ€™oÃ¹ le fait que lâ€™on nâ€™a pas Ã  se prÃ©occuper de dÃ©finir le rÃ©pertoire de travail lorsque lâ€™on travaille avec des projets RStudio) ;</li>
<li>les objets crÃ©Ã©s (et sauvegardÃ©s dans le fichier .Rdata) lors dâ€™une prÃ©cÃ©dente sÃ©ance de travail sont chargÃ©s en mÃ©moire ;</li>
<li>lâ€™historique des commandes saisies lors de nos prÃ©cÃ©dentes sÃ©ances de travail sont chargÃ©es dans lâ€™onglet History ;</li>
<li>les scripts ouverts lors dâ€™une prÃ©cÃ©dente sÃ©ance de travail sont automatiquement ouverts ;
divers paramÃ¨tres de RStudio sont restaurÃ©s dans lâ€™Ã©tat dans lequel ils Ã©taient la derniÃ¨re fois quâ€™on a travaillÃ© sur ce projet.</li>
</ul>
<p>Autrement dit, lorsquâ€™on ouvre un projet RStudio, on revient Ã  lâ€™Ã©tat de notre projet tel quâ€™il Ã©tait la derniÃ¨re fois que lâ€™on a travaillÃ© dessus.</p>
<p>PlutÃ´t Pratique, nâ€™est pas ?</p>
<p>Petite prÃ©cision toutefois, les librairies que lâ€™on avait chargÃ©es en mÃ©moire avec la fonction <code>library</code> ne sont pas systÃ©matiquement rechargÃ©es en mÃ©moire. Il faudra donc les appeler Ã  nouveau lors de notre sÃ©ance de travail.</p>
</div>
</div>
</div>
<div id="rendre-lisible-et-portable-son-projet" class="section level1">
<h1>Rendre lisible et portable son projet</h1>
<p>Un projet lisible, câ€™est un projet dans lequel on se retrouve facilement. Un projet portable ou autoportant est un projet qui peut Ãªtre â€œrejouÃ©â€ hors de votre session câ€™est Ã  dire que si vous passez lâ€™ensemble du dossier de votre projet Ã  un collaborateur, il devrait pouvoir le lancer sans erreur et avoir les mÃªmes sorties que vous.</p>
<div id="portabilitÃ©-dun-projet" class="section level2">
<h2>PortabilitÃ© dâ€™un projet</h2>
<ul>
<li><strong>Commencer toujours par un environnement propre au lieu dâ€™enregistrer lâ€™espace de travail.</strong></li>
</ul>
<p>Ceci permet de se rassurer que son projet fonctionne bien. En restaurant systÃ©matiquement lâ€™environnement de votre projet (câ€™est Ã  dire en restaurant le <code>.RData</code>) vous pouvez vous retrouver dans une situation oÃ¹ vous avez crÃ©Ã© un objet depuis la console et pas dans un script; puis de lâ€™utiliser. Si ce code est repris plus tard, on se saura pas dâ€™oÃ¹ il vient; ce qui est un peu embÃªtant.</p>
<p>Ã€ noter que mettre <code>rm(list=ls())</code> ne permet pas de partir dâ€™un environnement vierge. Il supprime juste les objets dans votre espace de travail. Votre projet restera vulnÃ©rable aux dÃ©pendances ou processus lancÃ©s depuis votre console (appel de librairie, mise dâ€™une option â€¦ ).</p>
<p>Le travail sous forme Rmarkdown ou Rnotebook permet aussi dâ€™appliquer cette bonne pratique. Utilisez ces formats de travail si possible.</p>
<ul>
<li><strong>Utiliser des chemins dâ€™accÃ¨s relatifs pour accÃ©der aux fichiers</strong>
<ul>
<li>Ne surtout pas faire de <code>setwd</code>.</li>
<li>Travailler en relatif depuis la racine du projet:
le package <code>here</code> peut vous aider pour appliquer cela.
<code>here</code> rÃ©cupÃ¨re le chemin relatif du projet. Ainsi, si le projet est utilisÃ© par un de vos collaborateurs, le chemin sâ€™adapte Ã  son rÃ©pertoire.</li>
</ul></li>
</ul>
<blockquote>
<p>Lâ€™article <a href="https://www.tidyverse.org/articles/2017/12/workflow-vs-script/">Project-oriented workflow</a> du <a href="https://www.tidyverse.org">Tidyverse</a> revient sur ces deux points.</p>
</blockquote>
<ul>
<li><strong>Conserver tous les fichiers sources dâ€™un projet dans un rÃ©pertoire</strong></li>
</ul>
<p>Lorsque vous travaillez sur un projet, Ã©viter autant que possible de rÃ©fÃ©rer Ã  des Ã©lÃ©ments dâ€™un autre projet. Tout le nÃ©cessaire dâ€™un projet doit Ãªtre dans le dossier du projet.</p>
<ul>
<li><strong>Mettre en place une arborescence simple et claire du projet</strong>
<ul>
<li>SÃ©parer les donnÃ©es (dans un dossier <strong>data</strong> par exemple) de vos scripts sources</li>
<li>Mettre les fonctions dans des fichiers sÃ©parÃ©s</li>
<li>Utiliser un fichier qui appelle toutes les librairies que vous utilisez (si vous avez plusieurs fichiers de scripts).</li>
<li>Avoir un fichier de config (si besoin)</li>
</ul></li>
<li><strong>Faire des packages quand on veut rÃ©utiliser du code entre projet</strong></li>
</ul>
<p>Un package R suit une structure bien dÃ©finie. Ainsi, tout ce que vous avez dÃ©veloppÃ© est accessible via des fonctions avec des aides appropriÃ©es. Le systÃ¨me de packages vous permet donc dâ€™avoir des fonctions, de la documentation (vignettes et pages dâ€™aide) et garantie une bonne portabilitÃ© de vos travaux (si tous les contrÃ´les sont bien fait) entre projet.</p>
<blockquote>
<p>Pour vous aider Ã  construire des packages, voici quelques ressources en ligne : le livre <a href="http://r-pkgs.had.co.nz/">R packages</a> de <em>Hadley Wickham</em> et lâ€™article <a href="https://thinkr.fr/creer-package-r-quelques-minutes/">CrÃ©er un package R en quelques minutes</a> du <a href="https://thinkr.fr/">thinkr</a>.</p>
</blockquote>
</div>
<div id="lisibilitÃ©-du-code" class="section level2">
<h2>LisibilitÃ© du code</h2>
<ul>
<li><strong>Bien indenter son code</strong></li>
</ul>
<p>Un code bien indentÃ© est facile Ã  lire. Un raccourci pour indenter une ligne de code est <strong>Ctrl +I</strong>. Pour reformater un script en entier, utilisez <strong>Ctrl+Shift+A</strong>.</p>
<ul>
<li><strong>Commenter son code</strong></li>
</ul>
<p>Utile mÃªme si vous travaillez seul. Vous vous retrouver plus facilement si vous reprenez votre projet plusieurs mois aprÃ¨s. Pour rajouter un commentaire il vous suffit de rajouter <strong>#</strong> avant votre commentaire (ou en raccourci <strong>Ctrl+Shift+C</strong>)</p>
<ul>
<li><strong>Mettre des sections dans votre code</strong></li>
</ul>
<p>Votre code nâ€™en sera que plus aÃ©rÃ©, agrÃ©able et facile Ã  lire. Le raccourci pour mettre une section est <strong>Ctrl+Shift+R</strong>.</p>
<ul>
<li><strong>Utiliser les <strong>Snippets</strong> sâ€™ils existent</strong></li>
</ul>
<p>Les snippets sont des bouts de code prÃ©enregistrÃ©s qui vous aident dans la structuration dâ€™un module. Pour les utiliser il suffit de commencer par Ã©crire la fonction/module et il vous sera proposÃ© un snippet sâ€™il en existe.
Quelques snippets:</p>
<ul>
<li><code>fun</code> : gÃ©nÃ¨re lâ€™arborescence pour Ã©crire une fonction,</li>
<li><code>shinyApp</code>: gÃ©nÃ¨re une arborescence avec le minimum pour faire une appli shiny</li>
<li><code>if</code>, <code>el</code>, and <code>ei</code> pour les expressions conditionnelles</li>
<li>â€¦</li>
</ul>
<p>â€ƒ Pour avoir la liste des snippets par dÃ©fauts aller dans <strong><em>Tools&gt;Global Option&gt;Code</em></strong> puis cliquer sur <strong>Edit Snippets â€¦</strong>.
Vous pouvez modifier/rajouter des snippets en modifiant/rajoutant ce quâ€™il vous faut dans lâ€™interface qui sâ€™est ouverte. Pour en savoir plus: <a href="https://support.rstudio.com/hc/en-us/articles/204463668-Code-Snippets">Code Snippets</a></p>
<blockquote>
<p>Pour avoir plus de conseils nâ€™hÃ©sitez pas Ã  lire <a href="https://csgillespie.github.io/efficientR/">Efficient R programming</a> de <em>Colin Gillespie &amp; Robin Lovelace</em> et plus prÃ©cisÃ©ment le chapitre <a href="https://csgillespie.github.io/efficientR/collaboration.html">Efficient collaboration</a>.</p>
</blockquote>
<blockquote>
<p>Le livre <a href="http://adv-r.had.co.nz/">Advanced R</a> de <em>Hadley Wickham</em> est aussi trÃ¨s intÃ©ressant pour amÃ©liorer vos compÃ©tences sur la programmation fonctionnelle, la performance de vos scripts â€¦</p>
</blockquote>
</div>
</div>
